<div class="profile-container">
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>

    <!-- Profile Header -->
    <div class="profile-header">
        <p-card>
            <div class="header-content">
                <div class="avatar-section">
                    <p-avatar *ngIf="!user?.avatar"
                              icon="pi pi-user"
                              styleClass="profile-avatar"
                              [style]="{ 'background-color': '#ece9fc', color: '#2a1261' }"
                              shape="circle" />
                    <p-avatar *ngIf="user?.avatar"
                              image="{{environment.apiUrl}}user/avatar/{{user?.avatar}}"
                              styleClass="mr-2"
                              [style]="{ 'background-color': '#ece9fc', color: '#2a1261' }"
                              shape="circle" />
                    <p-button
                            icon="pi pi-camera"
                            class="p-button-rounded p-button-secondary avatar-upload-btn"
                            (click)="showAvatarDialog = true"
                            pTooltip="Change Avatar">
                    </p-button>
                </div>

                <div class="user-info">
                    <h2>{{ user?.name || 'User' }}</h2>
                    <p class="user-email">{{ user?.email }}</p>
                    <p-chip
                            [label]="user?.role || 'USER'"
                            [styleClass]="user?.role === Role.SELLER ? 'seller-badge' : 'user-badge'">
                    </p-chip>
                </div>

                <div class="header-actions">
                    <p-button
                            label="Statistics"
                            icon="pi pi-chart-line"
                            class="p-button-outlined"
                            (click)="showStatistics()"
                            [loading]="statsLoading">
                    </p-button>
                </div>
            </div>
        </p-card>
    </div>

    <!-- Main Content Tabs -->
    <p-tabView>
        <!-- Profile Settings Tab -->
        <p-tabPanel header="Profile Settings" leftIcon="pi pi-user">
            <div class="profile-settings">
                <div class="settings-grid">
                    <!-- Basic Information -->
                        <form [formGroup]="editProfileForm" (ngSubmit)="saveEditProfile()">
                            <div class="dialog-form">
                                <div class="form-field">
                                    <label for="editName">First Name *</label>
                                    <input
                                            pInputText
                                            id="editName"
                                            formControlName="name"
                                            [class.ng-invalid]="isFieldInvalid(editProfileForm, 'name')">
                                    <small class="error-text" *ngIf="isFieldInvalid(editProfileForm, 'name')">
                                        {{ getFieldError(editProfileForm, 'name') }}
                                    </small>
                                </div>

                                <div class="form-field">
                                    <label for="editEmail">Email *</label>
                                    <input
                                            pInputText
                                            id="editEmail"
                                            formControlName="email"
                                            [class.ng-invalid]="isFieldInvalid(editProfileForm, 'email')">
                                    <small class="error-text" *ngIf="isFieldInvalid(editProfileForm, 'email')">
                                        {{ getFieldError(editProfileForm, 'email') }}
                                    </small>
                                </div>
                            </div>
                            <p-button
                                    label="Save Changes"
                                    icon="pi pi-check"
                                    (onClick)="saveEditProfile()"
                                    [disabled]="editProfileForm.invalid"
                            >
                            </p-button>
                        </form>

                </div>

                <!-- Change Password -->
                <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
                        <div class="dialog-form">
                            <div class="form-field">
                                <label for="currentPassword">Current Password *</label>
                                <input
                                        pInputText
                                        type="password"
                                        id="currentPassword"
                                        formControlName="currentPassword"
                                        [class.ng-invalid]="isFieldInvalid(passwordForm, 'currentPassword')">
                                <small class="error-text" *ngIf="isFieldInvalid(passwordForm, 'currentPassword')">
                                    {{ getFieldError(passwordForm, 'currentPassword') }}
                                </small>
                            </div>

                            <div class="form-field">
                                <label for="newPassword">New Password *</label>
                                <input
                                        pInputText
                                        type="password"
                                        id="newPassword"
                                        formControlName="newPassword"
                                        [class.ng-invalid]="isFieldInvalid(passwordForm, 'newPassword')">
                                <small class="error-text" *ngIf="isFieldInvalid(passwordForm, 'newPassword')">
                                    {{ getFieldError(passwordForm, 'newPassword') }}
                                </small>
                            </div>

                            <div class="form-field">
                                <label for="confirmPassword">Confirm Password *</label>
                                <input
                                        pInputText
                                        type="password"
                                        id="confirmPassword"
                                        formControlName="confirmPassword"
                                        [class.ng-invalid]="isFieldInvalid(passwordForm, 'confirmPassword')">
                                <small class="error-text" *ngIf="isFieldInvalid(passwordForm, 'confirmPassword')">
                                    {{ getFieldError(passwordForm, 'confirmPassword') }}
                                </small>
                            </div>
                        </div>
                        <p-button
                                label="Change Password"
                                icon="pi pi-check"
                                (click)="changePassword()"
                                [disabled]="passwordForm.invalid">
                        </p-button>
                    </form>

                <!-- Danger Zone -->
                <p-card header="Danger Zone" class="danger-card">
                    <div class="danger-actions">
                        <div class="danger-info">
                            <h4>Delete Account</h4>
                            <p>Permanently delete your account and all associated data. This action cannot be undone.</p>
                        </div>
                        <p-button
                                label="Delete Account"
                                icon="pi pi-trash"
                                class="p-button-danger"
                                (click)="deleteAccount()">
                        </p-button>
                    </div>
                </p-card>
            </div>
        </p-tabPanel>

        <!-- Orders Tab -->
        <p-tabPanel header="My Orders" leftIcon="pi pi-shopping-cart">
            <div class="orders-section">
                <!-- Search and Filter -->
                <p-card class="search-card">
                    <form [formGroup]="searchForm">
                        <div class="search-grid">
                            <div class="search-field">
                                <label for="searchKeyword">Search Orders</label>
                                <input
                                        pInputText
                                        id="searchKeyword"
                                        placeholder="Search by order ID, product name..."
                                        (input)="onSearchInput($event)"
                                        class="search-input">
                            </div>

                            <div class="filter-field">
                                <label for="statusFilter">Order Status</label>
                                <p-dropdown
                                        id="statusFilter"
                                        formControlName="status"
                                        [options]="statusOptions"
                                        placeholder="All Statuses"
                                        optionLabel="label"
                                        optionValue="value"
                                        [showClear]="true">
                                </p-dropdown>
                            </div>

                            <div class="filter-field">
                                <label for="paymentFilter">Payment Status</label>
                                <p-dropdown
                                        id="paymentFilter"
                                        formControlName="paymentStatus"
                                        [options]="paymentStatusOptions"
                                        placeholder="All Payment Status"
                                        optionLabel="label"
                                        optionValue="value"
                                        [showClear]="true">
                                </p-dropdown>
                            </div>

                            <div class="filter-field">
                                <label for="startDate">Start Date</label>
                                <p-calendar
                                        id="startDate"
                                        formControlName="startDate"
                                        [showIcon]="true"
                                        placeholder="From date">
                                </p-calendar>
                            </div>

                            <div class="filter-field">
                                <label for="endDate">End Date</label>
                                <p-calendar
                                        id="endDate"
                                        formControlName="endDate"
                                        [showIcon]="true"
                                        placeholder="To date">
                                </p-calendar>
                            </div>

                            <div class="action-buttons">
                                <p-button
                                        label="Clear Filters"
                                        icon="pi pi-filter-slash"
                                        class="p-button-outlined"
                                        (click)="clearFilters()">
                                </p-button>
                                <p-button
                                        label="Export"
                                        icon="pi pi-download"
                                        class="p-button-outlined"
                                        (click)="exportOrderHistory()">
                                </p-button>
                            </div>
                        </div>
                    </form>
                </p-card>

                <!-- Orders Table -->
                <p-card class="orders-table-card">
                    <ng-container *ngIf="!ordersLoading; else loadingSkeleton">
                        <p-table
                                [value]="filteredOrders"
                                [paginator]="false"
                                [responsive]="true"
                                styleClass="p-datatable-gridlines">

                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Order ID</th>
                                    <th>Date</th>
                                    <th>Items</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>Payment</th>
                                    <th>Actions</th>
                                </tr>
                            </ng-template>

                            <ng-template pTemplate="body" let-order>
                                <tr>
                                    <td>
                                        <strong>#{{ order.id }}</strong>
                                    </td>
                                    <td>
                                        {{ formatDate(order.createdAt) }}
                                    </td>
                                    <td>
                                        {{ order.orderItems?.length || 0 }} item(s)
                                    </td>
                                    <td>
                                        <strong>{{ formatCurrency(order.totalAmount) }}</strong>
                                    </td>
                                    <td>
                                        <p-tag
                                                [value]="order.orderStatus"
                                                [severity]="getOrderStatusSeverity(order.orderStatus)">
                                        </p-tag>
                                    </td>
                                    <td>
                                        <p-tag
                                                [value]="order.paymentStatus"
                                                [severity]="getPaymentStatusSeverity(order.paymentStatus)">
                                        </p-tag>
                                    </td>
                                    <td>
                                        <div class="order-actions">
                                            <p-button
                                                    icon="pi pi-eye"
                                                    class="p-button-text p-button-rounded"
                                                    pTooltip="View Details"
                                                    [routerLink]="['/order']"
                                                    [queryParams]="{ id: order.id }"
                                                    routerLinkActive="active"
                                                    ariaCurrentWhenActive="page">
                                            </p-button>

                                            <p-button
                                                    icon="pi pi-refresh"
                                                    class="p-button-text p-button-rounded"
                                                    (click)="reorderOrder(order)"
                                                    [disabled]="!canReorder(order)"
                                                    pTooltip="Reorder">
                                            </p-button>

                                            <p-button
                                                    icon="pi pi-times"
                                                    class="p-button-text p-button-rounded"
                                                    (click)="cancelOrder(order)"
                                                    [disabled]="!canCancelOrder(order)"
                                                    pTooltip="Cancel Order">
                                            </p-button>

                                            <p-button
                                                    icon="pi pi-download"
                                                    class="p-button-text p-button-rounded"
                                                    (click)="downloadReceipt(order)"
                                                    pTooltip="Download Receipt">
                                            </p-button>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>

                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="7" class="text-center">
                                        <div class="empty-state">
                                            <i class="pi pi-shopping-cart" style="font-size: 3rem; color: red"></i>
                                            <h3>No Orders Found</h3>
                                            <p>You haven't placed any orders yet or no orders match your search criteria.</p>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </ng-container>

                    <ng-template #loadingSkeleton>
                        <div class="loading-skeleton">
                            <p-skeleton height="3rem" class="mb-2" *ngFor="let item of [1,2,3,4,5]"></p-skeleton>
                        </div>
                    </ng-template>

                    <!-- Pagination -->
                    <p-paginator
                            *ngIf="totalOrders > 0"
                            [rows]="pageSize"
                            [totalRecords]="totalOrders"
                            [first]="currentPage * pageSize"
                            (onPageChange)="onPageChange($event)"
                            [rowsPerPageOptions]="[5, 10, 20, 50]">
                    </p-paginator>
                </p-card>
            </div>
        </p-tabPanel>

        <!-- Statistics Tab -->
        <p-tabPanel header="Statistics" leftIcon="pi pi-chart-bar" *ngIf="userStats">
            <div class="statistics-section">
                <div class="stats-grid">
                    <!-- Key Metrics Cards -->
                    <p-card class="metric-card">
                        <div class="metric-content">
                            <div class="metric-icon orders-icon">
                                <i class="pi pi-shopping-cart"></i>
                            </div>
                            <div class="metric-info">
                                <h3>{{ userStats?.totalOrders || 0 }}</h3>
                                <p>Total Orders</p>
                            </div>
                        </div>
                    </p-card>

                    <p-card class="metric-card">
                        <div class="metric-content">
                            <div class="metric-icon money-icon">
                                <i class="pi pi-dollar"></i>
                            </div>
                            <div class="metric-info">
                                <h3>{{ formatCurrency(getTotalMetric()) }}</h3>
                                <p>{{ getTotalMetricLabel() }}</p>
                            </div>
                        </div>
                    </p-card>

                    <p-card class="metric-card">
                        <div class="metric-content">
                            <div class="metric-icon monthly-icon">
                                <i class="pi pi-calendar"></i>
                            </div>
                            <div class="metric-info">
                                <h3>{{ formatCurrency(getMonthlyMetric()) }}</h3>
                                <p>{{ getMonthlyMetricLabel() }}</p>
                            </div>
                        </div>
                    </p-card>

                    <p-card class="metric-card">
                        <div class="metric-content">
                            <div class="metric-icon completion-icon">
                                <i class="pi pi-check-circle"></i>
                            </div>
                            <div class="metric-info">
                                <h3>{{ getCompletionRate().toFixed(1) }}%</h3>
                                <p>Completion Rate</p>
                            </div>
                        </div>
                    </p-card>
                </div>

                <!-- Chart Section -->
                <p-card header="Activity Overview" class="chart-card">
                    <div class="chart-container">
                        <p-chart
                                type="line"
                                [data]="chartData"
                                [options]="chartOptions"
                        >
<!--                                [height]="300"-->
                        </p-chart>
                    </div>
                </p-card>
            </div>
        </p-tabPanel>
    </p-tabView>

    <!-- Avatar Selection Dialog -->
    <p-dialog
            header="Choose Avatar"
            [(visible)]="showAvatarDialog"
            [modal]="true"
            [closable]="true"
            [style]="{width: '600px'}"
            (onHide)="closeAvatarDialog()">

        <div>
            <label class="block text-sm font-medium text-gray-700">Profile Picture</label>
            <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg">
                <div class="space-y-1 text-center">
                    <div class="flex text-sm text-gray-600">
                        <label for="avatar" class="relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500">
                            <span>Upload a file</span>
                            <input id="avatar"
                                   name="avatar"
                                   type="file"
                                   class="sr-only"
                                   (change)="onFileChange($event)">
                        </label>
                        <p class="pl-1">or drag and drop</p>
                    </div>
                    <p class="text-xs text-gray-500">
                        PNG, JPG, GIF up to 10MB
                    </p>
                </div>
            </div>

            <!-- Profile Picture Preview -->
            <div *ngIf="currentFile" class="mt-4 flex flex-col items-center">
                <div class="relative w-32 h-32 overflow-hidden border-2 border-indigo-200">
                    <img [src]="currentFile.preview" alt="Profile Preview" class="w-full h-full object-cover">
                    <button (click)="removeFile()" class="absolute top-1 right-1 bg-white/80 hover:bg-white p-1 shadow-md transition-all duration-300">
                        <i class="pi pi-times text-gray-600"></i>
                    </button>
                </div>
                <p class="mt-2 text-sm text-gray-500">{{ currentFile.fileName }}</p>
            </div>
            <p-button
                    label="Save Avatar"
                    icon="pi pi-check"
                    [disabled]="!currentFile"
                    (click)="uploadAvatar()">
            </p-button>
        </div>
    </p-dialog>

    <!-- Statistics Modal -->
    <p-dialog
            header="Detailed Statistics"
            [(visible)]="showStatsDialog"
            [modal]="true"
            [closable]="true"
            [style]="{width: '90vw', height: '80vh'}"
            (onHide)="closeStatsDialog()"
            *ngIf="userStats">

        <div class="detailed-stats">
            <div class="stats-overview">
                <div class="stat-card">
                    <h3>{{ userStats.totalOrders }}</h3>
                    <p>Total Orders</p>
                </div>

                <div class="stat-card">
                    <h3>{{ formatCurrency(getTotalMetric()) }}</h3>
                    <p>{{ getTotalMetricLabel() }}</p>
                </div>

                <div class="stat-card">
                    <h3>{{ formatCurrency(getMonthlyMetric()) }}</h3>
                    <p>{{ getMonthlyMetricLabel() }}</p>
                </div>

                <div class="stat-card">
                    <h3>{{ getCompletionRate().toFixed(1) }}%</h3>
                    <p>Completion Rate</p>
                </div>
            </div>

            <p-divider></p-divider>

            <div class="stats-content">
                <div class="stats-charts">
                    <p-card header="Activity Overview">
                        <p-chart
                                type="line"
                                [data]="chartData"
                                [options]="chartOptions"
                        >
<!--                                [height]="300"-->
                        </p-chart>
                    </p-card>
                </div>

                <div class="stats-details">
                    <p-tabView>
                        <!-- Orders Tab -->
                        <p-tabPanel header="Orders">
                            <div class="stats-table">
                                <h4>Order Statistics</h4>
                                <p-table [value]="[userStats]" responsiveLayout="scroll">
                                    <ng-template pTemplate="body">
                                        <tr>
                                            <td><strong>Total Orders</strong></td>
                                            <td>{{ userStats.totalOrders || 0 }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Completed Orders</strong></td>
                                            <td>{{ userStats.completedOrders || 0 }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Pending Orders</strong></td>
                                            <td>{{ userStats.pendingOrders || 0 }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Cancelled Orders</strong></td>
                                            <td>{{ userStats.cancelledOrders || 0 }}</td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        </p-tabPanel>

                        <!-- Financial Tab -->
                        <p-tabPanel header="Financial">
                            <div class="stats-table">
                                <h4>Financial Statistics</h4>
                                <p-table [value]="[userStats]" responsiveLayout="scroll">
                                    <ng-template pTemplate="body">
                                        <tr>
                                            <td><strong>{{ getTotalMetricLabel() }}</strong></td>
                                            <td>{{ formatCurrency(getTotalMetric()) }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>{{ getMonthlyMetricLabel() }}</strong></td>
                                            <td>{{ formatCurrency(getMonthlyMetric()) }}</td>
                                        </tr>
                                        <tr *ngIf="isUserStatistics(userStats)">
                                            <td><strong>Average Order Value</strong></td>
                                            <td>{{ formatCurrency(userStats.averageOrderValue || 0) }}</td>
                                        </tr>
                                        <tr *ngIf="!isUserStatistics(userStats)">
                                            <td><strong>Average Order Value</strong></td>
                                            <td>{{ formatCurrency(userStats.averageOrderValue || 0) }}</td>
                                        </tr>

<!--                                        <tr *ngIf="userStats.netRevenue !== undefined">-->
<!--                                            <td><strong>Net Revenue</strong></td>-->
<!--                                            <td>{{ formatCurrency(0) }}</td>-->
<!--                                        </tr>-->
                                    </ng-template>
                                </p-table>
                            </div>
                        </p-tabPanel>

                        <!-- Products Tab -->
                        <p-tabPanel header="Products">
                            <div class="stats-table">
                                <h4>Product Statistics</h4>
                                <p-table [value]="[userStats]" responsiveLayout="scroll">
                                    <ng-template pTemplate="body">
                                        <tr *ngIf="isUserStatistics(userStats) && userStats.mostPurchasedProductName">
                                            <td><strong>Most Purchased Product</strong></td>
                                            <td>{{ userStats.mostPurchasedProductName }} ({{ userStats.mostPurchasedProductQuantity || 0 }} times)</td>
                                        </tr>
                                        <tr *ngIf="!isUserStatistics(userStats) && userStats.bestSellingProductName">
                                            <td><strong>Best Selling Product</strong></td>
                                            <td>{{ userStats.bestSellingProductName }} ({{ userStats.bestSellingProductQuantity || 0 }} sold)</td>
                                        </tr>
                                        <tr *ngIf="isUserStatistics(userStats)">
                                            <td><strong>Total Items Purchased</strong></td>
                                            <td>{{ userStats.totalItemsPurchased || 0 }}</td>
                                        </tr>
                                        <tr *ngIf="!isUserStatistics(userStats)">
                                            <td><strong>Total Items Sold</strong></td>
                                            <td>{{ userStats.totalItemsSold || 0 }}</td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        </p-tabPanel>

                        <!-- Timeline Tab -->
                        <p-tabPanel header="Timeline">
                            <div class="stats-timeline">
                                <h4>Activity Timeline</h4>
                                <p-timeline [value]="getTimelineEvents()" align="alternate">
                                    <ng-template pTemplate="content" let-event>
                                        <p-card>
                                            <div class="timeline-event">
                                                <h5>{{ event.title }}</h5>
                                                <p>{{ event.description }}</p>
                                                <small>{{ formatDateTime(event.date) }}</small>
                                            </div>
                                        </p-card>
                                    </ng-template>
                                </p-timeline>
                            </div>
                        </p-tabPanel>
                    </p-tabView>
                </div>
            </div>
        </div>

        <ng-template pTemplate="footer">
            <p-button
                    label="Close"
                    icon="pi pi-times"
                    (click)="closeStatsDialog()">
            </p-button>
        </ng-template>
    </p-dialog>
</div>















<!-- Order Details Dialog -->
<!--    <p-dialog-->
<!--            header="Order Details"-->
<!--            [(visible)]="showOrderDialog"-->
<!--            [modal]="true"-->
<!--            [closable]="true"-->
<!--            [style]="{width: '800px'}"-->
<!--            (onHide)="closeOrderDialog()"-->
<!--            *ngIf="selectedOrder">-->

<!--        <div class="order-details">-->
<!--            <div class="order-header">-->
<!--                <div class="order-info">-->
<!--                    <h3>Order #{{ selectedOrder.id }}</h3>-->
<!--                    <p>Placed on {{ formatDateTime(selectedOrder.createdAt) }}</p>-->
<!--                </div>-->
<!--                <div class="order-status">-->
<!--                    <p-tag-->
<!--                            [value]="getOrderStatusSeverity(selectedOrder.orderStatus)"-->
<!--                            [severity]="getOrderStatusSeverity(selectedOrder.orderStatus)">-->
<!--                    </p-tag>-->
<!--                    <p-tag-->
<!--                            [value]="selectedOrder.paymentStatus"-->
<!--                            [severity]="getPaymentStatusSeverity(selectedOrder.paymentStatus)">-->
<!--                    </p-tag>-->
<!--                </div>-->
<!--            </div>-->

<!--            <p-divider></p-divider>-->

<!--            <div class="order-items">-->
<!--                <h4>Order Items</h4>-->
<!--                <div class="item-list">-->
<!--                    <div *ngFor="let item of selectedOrder.orderItems" class="order-item">-->
<!--                        <div class="item-info">-->
<!--                            <h5>{{ item.productName }}</h5>-->
<!--                            <p>Quantity: {{ item.quantity }}</p>-->
<!--                            <p>Price: {{ formatCurrency(item.unitPrice) }}</p>-->
<!--                        </div>-->
<!--                        <div class="item-total">-->
<!--                            {{ formatCurrency(item.quantity * item.unitPrice) }}-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--            <p-divider></p-divider>-->

<!--            <div class="order-summary">-->
<!--                <div class="summary-row">-->
<!--                    <span>Subtotal:</span>-->
<!--                    <span>{{ formatCurrency(selectedOrder.totalAmount - (selectedOrder.shipping || 0)) }}</span>-->
<!--                </div>-->
<!--                <div class="summary-row" *ngIf="selectedOrder.shipping">-->
<!--                    <span>Shipping:</span>-->
<!--                    <span>{{ formatCurrency(selectedOrder.shipping) }}</span>-->
<!--                </div>-->
<!--                <div class="summary-row total">-->
<!--                    <strong>Total: {{ formatCurrency(selectedOrder.totalAmount) }}</strong>-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="shipping-info" *ngIf="selectedOrder.shippingAddress">-->
<!--                <h4>Shipping Address</h4>-->
<!--                <address>-->
<!--                    {{ selectedOrder.shippingAddress.address1 }}<br>-->
<!--                    {{ selectedOrder.shippingAddress.city }}, {{ selectedOrder.shippingAddress.state }} {{ selectedOrder.shippingAddress.postalCode }}<br>-->
<!--                    {{ selectedOrder.shippingAddress.country }}-->
<!--                </address>-->
<!--            </div>-->
<!--        </div>-->

<!--        <ng-template pTemplate="footer">-->
<!--            <p-button-->
<!--                    label="Close"-->
<!--                    icon="pi pi-times"-->
<!--                    class="p-button-text"-->
<!--                    (click)="closeOrderDialog()">-->
<!--            </p-button>-->
<!--            <p-button-->
<!--                    label="Download Receipt"-->
<!--                    icon="pi pi-download"-->
<!--                    (click)="downloadReceipt(selectedOrder)">-->
<!--            </p-button>-->
<!--        </ng-template>-->
<!--    </p-dialog>-->

<!-- Order Tracking Dialog -->
<!--    <p-dialog-->
<!--            header="Order Tracking"-->
<!--            [(visible)]="showOrderTrackingDialog"-->
<!--            [modal]="true"-->
<!--            [closable]="true"-->
<!--            [style]="{width: '600px'}"-->
<!--            (onHide)="closeOrderTrackingDialog()"-->
<!--            *ngIf="orderTrackingInfo">-->

<!--        <div class="tracking-info">-->
<!--            <p-timeline [value]="orderTrackingInfo.events" layout="vertical">-->
<!--                <ng-template pTemplate="content" let-event>-->
<!--                    <p-card>-->
<!--                        <div class="tracking-event">-->
<!--                            <h5>{{ event.status }}</h5>-->
<!--                            <p>{{ event.description }}</p>-->
<!--                            <small>{{ formatDateTime(event.timestamp) }}</small>-->
<!--                            <p *ngIf="event.location"><strong>Location:</strong> {{ event.location }}</p>-->
<!--                        </div>-->
<!--                    </p-card>-->
<!--                </ng-template>-->
<!--            </p-timeline>-->

<!--            <div class="tracking-number" *ngIf="orderTrackingInfo.trackingNumber">-->
<!--                <h4>Tracking Number</h4>-->
<!--                <p>{{ orderTrackingInfo.trackingNumber }}</p>-->
<!--            </div>-->

<!--            <div class="estimated-delivery" *ngIf="orderTrackingInfo.estimatedDelivery">-->
<!--                <h4>Estimated Delivery</h4>-->
<!--                <p>{{ formatDate(orderTrackingInfo.estimatedDelivery) }}</p>-->
<!--            </div>-->
<!--        </div>-->

<!--        <ng-template pTemplate="footer">-->
<!--            <p-button-->
<!--                    label="Close"-->
<!--                    icon="pi pi-times"-->
<!--                    class="p-button-text"-->
<!--                    (click)="closeOrderTrackingDialog()">-->
<!--            </p-button>-->
<!--        </ng-template>-->
<!--    </p-dialog>-->
